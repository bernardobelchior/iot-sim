<script type="text/javascript">
  (function() {
    RED.nodes.registerType("test-runner", {
      category: "Testing",
      color: "#87a980",
      defaults: {
        name: { value: "test-runner" },
        flow: { value: "", required: true},
        outputs: {value: 1, required: true},
      },
      icon: "switch.png",
      label: function() {
        return this.name || "Test Runner";
      },
      oneditprepare: function() {
        const flows = new Set();
        RED.nodes.eachNode(n => flows.add(n.z));

        flows.forEach(flowId => {
          $("#node-input-flow").append("<option value='" + flowId + "'>" + flowId + "</option>");
        });
      }
    });
  })();
</script>

<script type="text/x-red" data-template-name="test-runner">
    <div class="form-row">
        <label for="node-input-name"><i class="icon-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
    <div class="form-row">
        <label for="node-input-flow"><i class="icon-tag"></i> Flow</label>
        <select id="node-input-flow" name="flow" placeholder="Flow">
        </select>
    </div>
    <div class="form-row">
        <label for="node-input-outputs"><i class="icon-tag"></i> Outputs</label>
        <input id="node-input-outputs" type="number" name="outputs" placeholder="Outputs" value="1"/>
    </div>
</script>

<script type="text/x-red" data-help-name="test-runner">
    <p>Runs tests sequentially. Every test starts with a "test-start" node and ends with a "test-end" node. If two tests can be run simultaneously,
    connect the "test-start" to the same output, otherwise (to run them sequentially) hook each one up to a different output. </p>
</script>
